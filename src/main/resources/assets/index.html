<html>
<head>
  <style>
    form {
      margin: 10px 50px;
      padding-bottom: 10px;
      border-bottom: 1px solid black;
    }
    form span {
      margin: 10px;
    }
    .chart div {
      font: 10px sans-serif;
      background-color: steelblue;
      text-align: right;
      padding: 3px;
      margin: 1px;
      color: white;
    }
    path {
      stroke: steelblue;
      stroke-width: 2;
      fill: none;
    }
  </style>
  <script type="text/javascript" src="/assets/jquery.min.js"></script>
  <script type="text/javascript" src="/assets/d3.v4.min.js"></script>
  <script type="text/javascript" src="/dev/chronostream.js"></script>
</head>
<body>

<div id="error"></div>
<div id="form">Loading...</div>

<script type="text/babel">
/*    componentDidMount() {
      // keep fetching data until we have everything
      this.chart = new CanvasJS.Chart("chart-" + this.props.id, {
        title: {
          text: "the chart"
        }, axisY: {maximum: 0}, data: [{type: "column", dataPoints: []}]
      });
      window.debugChart = this.chart;
      window.debugArr = this;

      this.results()
    }

    results() {
      $.ajax({
        url: '/tests/results?id=' + this.props.id + '&offset=' + this.arr.length
      }).done(data => {
        if (data.exception) {
          console.error(data.exception);
          this.setState({exception: data.exception});
        }
        for (var i = 0; i < data.startEndTimes.length; i++) {
          var v = data.startEndTimes[i].endTime - data.startEndTimes[i].startTime;
          this.arr.push(v);
          this.chart.options.data[0].dataPoints.push({x: this.arr.length, y: v});
          if (v > this.chart.options.axisY.maximum) {
            this.chart.options.axisY.maximum = v;
          }
          if (this.chart.options.data[0].dataPoints.length > 20000) {
            this.chart.options.data[0].dataPoints.shift();
          }
        }
        this.chart.render()

        // get more data
        if ((data.total == 0) || (this.arr.length < data.total)) {
          this.results();
        } else {
          this.setState({status: "done."});
          //plotPercentile(this.chart, arr)
        }
      }).fail(err => {
        console.error(err);
        this.setState({status: err.status + ": " + err.statusText})
      })
    }

    render() {
      return <div>
        <div id={"chart-" + this.props.id} style={{height: '300px', width: '100%'}}></div>
        <p>{this.state.status}</p>
        <p>{this.state.exception}</p>
      </div>;
    }
  }
  */
</script>
</body>
</html>
